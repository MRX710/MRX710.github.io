"use strict";(self.webpackChunkproduction_project=self.webpackChunkproduction_project||[]).push([[603],{5506:(e,t,n)=>{n.r(t),n.d(t,{default:()=>R});var r=n(5893),i=n(7294),o=n(2327),a=n(5003),l=n(4250),s=n(6974),c=n(1545),u=n(9475),d=n(8371),v=n(5437),f=n(4069),h=n(1723);const m="xIHByGcu",p="hv7uWGUp",x="Az7Xne5P",y="wyB5ncg2";var b=function(){return b=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},b.apply(this,arguments)},w=(0,i.memo)((function(e){var t,n,i,o,l=e.className,s=e.comment;return e.isLoading?(0,r.jsxs)("div",b({className:(0,a.A)(m,{},[l,"cz15cwHq"])},{children:[(0,r.jsxs)("div",b({className:p},{children:[(0,r.jsx)(v.O,{width:30,height:30,border:"50%"},void 0),(0,r.jsx)(v.O,{width:100,height:16,className:x},void 0)]}),void 0),(0,r.jsx)(v.O,{width:"100%",height:50,className:y},void 0)]}),void 0):s?(0,r.jsxs)("div",b({className:(0,a.A)(m,{},[l])},{children:[(0,r.jsxs)(f.F,b({to:"".concat(h.h3.profile).concat(null===(t=null==s?void 0:s.user)||void 0===t?void 0:t.id),className:p},{children:[(null===(n=null==s?void 0:s.user)||void 0===n?void 0:n.avatar)?(0,r.jsx)(d.q,{width:30,height:30,src:null===(i=null==s?void 0:s.user)||void 0===i?void 0:i.avatar},void 0):null,(0,r.jsx)(c.xv,{className:x,title:null===(o=null==s?void 0:s.user)||void 0===o?void 0:o.username},void 0)]}),void 0),(0,r.jsx)(c.xv,{className:y,text:null==s?void 0:s.text},void 0)]}),void 0):null}));const g={CommentList__comment:"PgTLXyd2"};var j=function(){return j=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},j.apply(this,arguments)},C=(0,i.memo)((function(e){var t=e.className,n=e.isLoading,i=e.comments,l=(0,o.$)().t;return n?(0,r.jsxs)("div",j({className:(0,a.A)(g.CommentList,{},[t])},{children:[(0,r.jsx)(w,{isLoading:n},void 0),(0,r.jsx)(w,{isLoading:n},void 0)]}),void 0):(0,r.jsx)("div",j({className:(0,a.A)(g.CommentList,{},[t])},{children:i&&(0,u.h)(i)?i.map((function(e){return(0,r.jsx)(w,{className:g.CommentList__comment,comment:e,isLoading:n},null==e?void 0:e.id)})):(0,r.jsx)(c.xv,{text:l("Комментарии отсутствуют")},void 0)}),void 0)})),L=n(8225),N=n(9704),k=n(6561),A=n(5895),O=(0,i.lazy)((function(){return new Promise((function(e){setTimeout((function(){return e(n.e(301).then(n.bind(n,5301)))}),1500)}))})),S=n(8765),T=n(3372),D=n(7168),I=(0,D.hg)("articleDetails/fetchCommentsByArticleId",(function(e,t){return n=void 0,r=void 0,o=function(){var n,r,i;return function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(o){switch(o.label){case 0:if(n=t.extra,r=t.rejectWithValue,!e)return[2,r("error")];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,n.api.get("/comments",{params:{articleId:e,_expand:"user"}})];case 2:if(!(null==(i=o.sent())?void 0:i.data))throw new Error;return[2,i.data];case 3:return o.sent(),[2,r("error")];case 4:return[2]}}))},new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{s(o.next(e))}catch(e){t(e)}}function l(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,l)}s((o=o.apply(n,r||[])).next())}));var n,r,i,o})),P=n(1501),_=n(3343),E=(0,D.hg)("articleDetails/addCommentForArticle",(function(e,t){return n=void 0,r=void 0,o=function(){var n,r,i,o,a,l,s;return function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function l(o){return function(l){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,l])}}}(this,(function(c){switch(c.label){case 0:if(n=t.extra,r=t.dispatch,i=t.rejectWithValue,o=t.getState,a=(0,P.m5)(o()),l=(0,_.wq)(o()),!a||!e||!l)return[2,i("no data")];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,n.api.post("/comments",{articleId:null==l?void 0:l.id,userId:null==a?void 0:a.id,text:e})];case 2:if(!(s=c.sent()).data)throw new Error;return r(I(null==l?void 0:l.id)),[2,s.data];case 3:return c.sent(),[2,i("error")];case 4:return[2]}}))},new((i=void 0)||(i=Promise))((function(e,t){function a(e){try{s(o.next(e))}catch(e){t(e)}}function l(e){try{s(o.throw(e))}catch(e){t(e)}}function s(t){var n;t.done?e(t.value):(n=t.value,n instanceof i?n:new i((function(e){e(n)}))).then(a,l)}s((o=o.apply(n,r||[])).next())}));var n,r,i,o})),G=function(e){var t;return null===(t=null==e?void 0:e.articleDetailsComments)||void 0===t?void 0:t.isLoading},z=function(e){var t;return null===(t=null==e?void 0:e.articleDetailsComments)||void 0===t?void 0:t.error};const U={commentTitle:"XsGa2Vpk"};var W=(0,D.HF)({selectId:function(e){return e.id}}),q=W.getSelectors((function(e){return(null==e?void 0:e.articleDetailsComments)||W.getInitialState()})),B=(0,D.oM)({name:"ArticleDetailsCommentsSlice",initialState:W.getInitialState({isLoading:!1,error:void 0,ids:[],entities:{}}),reducers:{},extraReducers:function(e){e.addCase(I.pending,(function(e,t){e.error=void 0,e.isLoading=!0})).addCase(I.fulfilled,(function(e,t){e.isLoading=!1,W.setAll(e,null==t?void 0:t.payload)})).addCase(I.rejected,(function(e,t){e.isLoading=!1,e.error=t.payload}))}}),F=(B.actions,B.reducer),H=function(){return H=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},H.apply(this,arguments)},V={articleDetailsComments:F},X=function(){var e=(0,o.$)("article").t,t=(0,s.UO)().id,n=(0,A.T)(),u=(0,N.v9)(q.selectAll),d=(0,N.v9)(G),v=((0,N.v9)(z),(0,s.s0)());(0,k.Q)((function(){n(I(t))}));var f=(0,i.useCallback)((function(e){n(E(e))}),[n]),m=(0,i.useCallback)((function(){v(h.h3.articles)}),[v]);return t?(0,r.jsx)(L.W,H({reducers:V,removeReducerAfterUnmount:!0},{children:(0,r.jsxs)(T.T,H({className:(0,a.A)("",{},[])},{children:[(0,r.jsx)(S.zx,H({onClick:m,theme:S.bn.OUTLINE},{children:e("Назад к спиcку")}),void 0),(0,r.jsx)(l.D0,{id:t},void 0),(0,r.jsx)(c.xv,{className:U.commentTitle,title:e("Комментарии")},void 0),(0,r.jsx)(O,{onSendComment:f},void 0),(0,r.jsx)(C,{isLoading:d,comments:u},void 0)]}),void 0)}),void 0):(0,r.jsx)(T.T,H({className:(0,a.A)(U.ArticleDetailPage,{},[])},{children:e("Статья не найдена")}),void 0)};const R=(0,i.memo)(X)}}]);